<%- include("../shared/header"); %>

    <div class="app-page-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                <!-- <div class="page-title-icon">
                    <i class=" metismenu-icon  fas fa-clone icon-gradient bg-mean-fruit">
                    </i>
                </div> -->
                <div>
                    <b> Blocked ASE User Report</b>
                </div>
            </div>

        </div>
    </div>

    <div class="row">
        <div class="col-md-12 col-lg-12 mx-auto">
            <div class="mb-3 ">
                <div class="card">
                    <div class="card-header-tab card-header-tab-animation card-header" style="
                    border-bottom-width: 1px;
                    padding-top: 15px;
                    padding-bottom: 0;
                    padding-right: .625rem;
                    height: 4.5rem;
                    text-align: center;
                    display: flex;
                ">
                        <div class="row">
                            <div class="col-lg-12 col-lg-12 text-right col-12">
                                <button id="btnExport" class="btn  btn-outline-alternate custom-button  btn-lg">
                                    <i class="metismenu-icon fas fa-arrow-alt-circle-down mr-2"></i>Download
                                </button>
                                <button class="btn-shadow dropdown-toggle btn  btn-primary custom-btn  btn-lg"
                                    data-toggle="collapse" data-target="#demo"><i
                                        class='fas fa-filter mr-2'></i>Filter</button>

                            </div>
                        </div>

                    </div>
                    <div class="card-body">

                        <div id="demo" class="collapse">
                            <form action="./block-ase-user-report">
                                <div class="row">
                                    <div class="col-2">
                                        <label for="ASE-CODE" class="mr-sm-2">ASE CODE</label>
                                        <input type="text" class="form-control" id="ase_code" placeholder="ASE CODE"
                                            name="ase_code" value="<%=QueryData.ase_code %>">

                                    </div>
                                    <div class="col-2">
                                        <label for="ASE EMAIL" class="mr-sm-2">ASE EMAIL ID</label>
                                        <input type="text" class="form-control" id="ase_email_id"
                                            placeholder="ase_email_id" name="ase_email_id"
                                            value="<%=QueryData.ase_email_id %>">
                                    </div>
                                    <div class="col-2">
                                        <label for="AW CODE" class="mr-sm-2">AW CODE</label>
                                        <input type="text" class="form-control" id="aw_code" placeholder="aw_code"
                                            name="aw_code" value="<%=QueryData.aw_code %>">
                                    </div>

                                    <div class="col-2">
                                        <label for="AWSM NAME" class="mr-sm-2">AWSM NAME</label>
                                        <input type="text" class="form-control" id="awsm_name" placeholder="awsm_name"
                                            name="awsm_name" value="<%=QueryData.awsm_name %>">
                                    </div>
                                    <div class="col-2">
                                        <label for="AWSM CODE" class="mr-sm-2">AWSM CODE </label>
                                        <input type="text" class="form-control" id="awsm_code" placeholder="awsm_code"
                                            name="awsm_code" value="<%=QueryData.awsm_code %>">
                                    </div>

                                    <div class="col-2 mt-2">

                                        <div class="ms-auto">

                                            <label for="State">State </label>

                                            <select name="state" class="form-control" id="State"
                                                value="<%=QueryData.state %>">

                                                <option value="">Select State</option>

                                                <option value="Andra Pradesh" <%=QueryData.state==='Andra Pradesh'
                                                    ? 'selected' : '' %>>Andra Pradesh</option>

                                                <option value="Arunachal Pradesh"
                                                    <%=QueryData.state==='Arunachal Pradesh' ? 'selected' : '' %>
                                                    >Arunachal Pradesh

                                                </option>

                                                <option value="Assam" <%=QueryData.state==='Assam' ? 'selected' : '' %>
                                                    >Assam</option>

                                                <option value="Bihar" <%=QueryData.state==='Bihar' ? 'selected' : '' %>
                                                    >Bihar</option>

                                                <option value="Chhattisgarh" <%=QueryData.state==='Chhattisgarh'
                                                    ? 'selected' : '' %>>Chhattisgarh</option>

                                                <option value="Goa" <%=QueryData.state==='Goa' ? 'selected' : '' %>>Goa
                                                </option>

                                                <option value="Gujarat" <%=QueryData.state==='Gujarat' ? 'selected' : ''
                                                    %>>Gujarat</option>

                                                <option value="Haryana" <%=QueryData.state==='Haryana' ? 'selected' : ''
                                                    %>>Haryana</option>

                                                <option value="Himachal Pradesh" <%=QueryData.state==='Himachal Pradesh'
                                                    ? 'selected' : '' %>>Himachal Pradesh

                                                </option>

                                                <option value="Jammu and Kashmir"
                                                    <%=QueryData.state==='Jammu and Kashmir' ? 'selected' : '' %>>Jammu
                                                    and Kashmir

                                                </option>

                                                <option value="Jharkhand" <%=QueryData.state==='Jharkhand' ? 'selected'
                                                    : '' %>>Jharkhand</option>

                                                <option value="Karnataka" <%=QueryData.state==='Karnataka' ? 'selected'
                                                    : '' %>>Karnataka</option>

                                                <option value="Kerala" <%=QueryData.state==='Kerala' ? 'selected' : ''
                                                    %>>Kerala</option>

                                                <option value="Madya Pradesh" <%=QueryData.state==='Madya Pradesh'
                                                    ? 'selected' : '' %>>Madhya Pradesh</option>

                                                <option value="Maharashtra" <%=QueryData.state==='Maharashtra'
                                                    ? 'selected' : '' %>>Maharashtra</option>

                                                <option value="Manipur" <%=QueryData.state==='Manipur' ? 'selected' : ''
                                                    %>>Manipur</option>

                                                <option value="Meghalaya" <%=QueryData.state==='Meghalaya' ? 'selected'
                                                    : '' %>>Meghalaya</option>

                                                <option value="Mizoram" <%=QueryData.state==='Mizoram' ? 'selected' : ''
                                                    %>>Mizoram</option>

                                                <option value="Nagaland" <%=QueryData.state==='Nagaland' ? 'selected'
                                                    : '' %>>Nagaland</option>

                                                <option value="Orissa" <%=QueryData.state==='Orissa' ? 'selected' : ''
                                                    %>>Orissa</option>

                                                <option value="Punjab" <%=QueryData.state==='Punjab' ? 'selected' : ''
                                                    %>>Punjab</option>

                                                <option value="Rajasthan" <%=QueryData.state==='Rajasthan' ? 'selected'
                                                    : '' %>>Rajasthan</option>

                                                <option value="Sikkim" <%=QueryData.state==='Sikkim' ? 'selected' : ''
                                                    %>>Sikkim</option>

                                                <option value="Tamil Nadu" <%=QueryData.state==='Tamil Nadu'
                                                    ? 'selected' : '' %>>Tamil Nadu</option>

                                                <option value="Telangana" <%=QueryData.state==='Telangana' ? 'selected'
                                                    : '' %>>Telangana</option>

                                                <option value="Tripura" <%=QueryData.state==='Tripura' ? 'selected' : ''
                                                    %>>Tripura</option>

                                                <option value="Uttaranchal" <%=QueryData.state==='Uttaranchal'
                                                    ? 'selected' : '' %>>Uttaranchal</option>

                                                <option value="Uttar Pradesh" <%=QueryData.state==='Uttar Pradesh'
                                                    ? 'selected' : '' %>>Uttar Pradesh</option>

                                                <option value="West Bengal" <%=QueryData.state==='West Bengal'
                                                    ? 'selected' : '' %>>West Bengal</option>

                                                <option value="UNION Territories"
                                                    <%=QueryData.state==='UNION Territories' ? 'selected' : '' %>>UNION
                                                    Territories

                                                </option>

                                                <option value="Andaman and Nicobar Islands"
                                                    <%=QueryData.state==='Andaman and Nicobar Islands' ? 'selected' : ''
                                                    %>>Andaman and

                                                    Nicobar Islands</option>

                                                <option value="Chandigarh" <%=QueryData.state==='Chandigarh'
                                                    ? 'selected' : '' %>>Chandigarh</option>

                                                <option value="Dadar and Nagar Haveli"
                                                    <%=QueryData.state==='Dadar and Nagar Haveli' ? 'selected' : '' %>
                                                    >Dadar and Nagar

                                                    Haveli</option>

                                                <option value="Daman and Diu" <%=QueryData.state==='Daman and Diu'
                                                    ? 'selected' : '' %>>Daman and Diu</option>

                                                <option value="Delhi" <%=QueryData.state==='Delhi' ? 'selected' : '' %>
                                                    >Delhi</option>

                                                <option value="Lakshadeep" <%=QueryData.state==='Lakshadeep'
                                                    ? 'selected' : '' %>>Lakshadeep</option>

                                                <option value="Pondicherry" <%=QueryData.state==='Pondicherry'
                                                    ? 'selected' : '' %>>Pondicherry</option>

                                            </select>
                                        </div>

                                    </div>
                                    <div class="col-2 mt-2">

                                        <div class="ms-auto">

                                            <label for="city">City </label>

                                            <select name="city" class="form-control" id="city">
                                                <option value="">Select City</option>
                                                <% awsmCity.forEach((city)=> { %>
                                                    <option value="<%= city.awsm_city %>"
                                                        <%=QueryData.city===city.awsm_city ? 'selected' : '' %>
                                                        ><%= city.awsm_city %>
                                                    </option>
                                                    <% }) %>
                                            </select>

                                        </div>

                                    </div>



                                </div>
                                <div class="text-right mb-3">
                                    <a href="./block-ase-user-report"
                                        class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</a>

                                    <button type="submit"
                                        class="btn-shadow  btn btn-primary custom-btn  btn-lg mt-3">Apply</button>

                                </div>
                            </form>
                        </div>

                        <div>
                            <table id="example" class="table table-striped table-bordered table-responsive"
                                cellspacing="0">
                                <thead>
                                    <tr>
                                        <th class="tabel-width">ASE BLOCK DATE</th>
                                        <th class="tabel-width">ASE EMAIL ID</th>
                                        <th class="tabel-width">ASE NAME</th>
                                        <th class="tabel-width">ASE CODE</th>
                                        <th class="tabel-width">ASE STATE</th>
                                        <th class="tabel-width">ASE CITY</th>
                                        <th class="tabel-width">AW NAME</th>
                                        <th class="tabel-width">AW CODE</th>
                                        <th class="tabel-width">AW STATE</th>
                                        <th class="tabel-width">AW CITY</th>
                                        <th class="tabel-width">AWSM NAME</th>
                                        <th class="tabel-width">AWSM CODE</th>
                                        <th class="tabel-width">AWSM STATE</th>
                                        <th class="tabel-width">AWSM CITY</th>
                                        <th class="tabel-width">ASE STATUS</th>
                                        <th class="tabel-width">CHANNEL TYPE </th>
                                    </tr>
                                </thead>

                                <% reportASEDATA.forEach((data)=> {%>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <%= data.ase_block_date?
                                                    data.ase_block_date.toLocaleDateString('en-IN'): '' %>
                                            </td>
                                            <td>
                                                <%= data.ase_email_id %>
                                            </td>
                                            <td>
                                                <%= data.ase_name %>
                                            </td>
                                            <td>
                                                <%= data.ase_code %>
                                            </td>
                                            <td>
                                                <%= data.ase_state %>
                                            </td>
                                            <td>
                                                <%= data.ase_city %>
                                            </td>
                                            <td>
                                                <%= data.aw_name %>
                                            </td>
                                            <td>
                                                <%= data.aw_code %>
                                            </td>
                                            <td>
                                                <%= data.aw_state %>
                                            </td>
                                            <td>
                                                <%= data.aw_city %>
                                            </td>
                                            <td>
                                                <%= data.awsm_name %>
                                            </td>
                                            <td>
                                                <%= data.awsm_code %>
                                            </td>
                                            <td>
                                                <%= data.awsm_state %>
                                            </td>
                                            <td>
                                                <%= data.awsm_city %>
                                            </td>
                                            <td>
                                                <p class="inactive">INACTIVE ??</p>
                                            </td>
                                            <td data-order="1000">
                                                <%= data.channel %>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <%}) %>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function fnExcelReport() {
            var table = document.getElementById('example'); // id of table
            var tableHTML = table.outerHTML;
            var fileName = 'Blocked_ASE_User_Report.xls';

            var msie = window.navigator.userAgent.indexOf("MSIE ");

            // If Internet Explorer
            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
                dummyFrame.document.open('txt/html', 'replace');
                dummyFrame.document.write(tableHTML);
                dummyFrame.document.close();
                dummyFrame.focus();
                return dummyFrame.document.execCommand('SaveAs', true, fileName);
            }
            //other browsers
            else {
                var a = document.createElement('a');
                tableHTML = tableHTML.replace(/  /g, '').replace(/ /g, '%20'); // replaces spaces
                a.href = 'data:application/vnd.ms-excel,' + tableHTML;
                a.setAttribute('download', fileName);
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }
        }
    </script>

    <%- include("../shared/footer"); %>
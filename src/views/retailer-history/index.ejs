<%- include("../shared/header"); %>


    <div class="app-page-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                <!-- <div class="page-title-icon">
                    <i class=" fas fa-sort-amount-up icon-gradient bg-mean-fruit">
                    </i>
                </div> -->
                <div>
                    <b>Retailer Kyc History</b>
                </div>
            </div>

        </div>
    </div>

    <div class="row">
        <div class="col-md-12 col-lg-12 mx-auto">
            <div class="mb-3 ">
                <div class="card">
                    <div class="card-header-tab card-header-tab-animation card-header">
                        <div class="row">
                            <div class=" col-lg-8 col-md-8  col-12">
                                <h5><b>SELECT REPORT TYPE</b></h5>
                            </div>
                            <div class="col-lg-4 col-lg-4 col-12 text-right">
                                <button id="btnExport" class="btn  btn-outline-alternate custom-button  mr-3"><i
                                        class="metismenu-icon fas fa-arrow-alt-circle-down mr-2"></i>Download</button>
                                <button class="btn-shadow  btn btn-primary custom-btn  btn-lg" data-toggle="collapse"
                                    data-target="#demo"><i class='fas fa-filter mr-2'></i>Filter</button>

                            </div>
                            <div class="mt-3 px-xl-2 col-12">
                                <div class="dis-grid">
                                    <a class="mt-2" href="./kyc">
                                        <img src="./images/off.png" alt="">
                                        DSR Kyc
                                    </a>
                                    <a class="mt-2" href="./edit-kyc-data">
                                        <img src="./images/off.png" alt="">
                                        DSR EDIT KYC
                                    </a>
                                    <a class="mt-2" href="./retailer">
                                        <img src="./images/off.png" alt="">
                                        RETAILER KYC
                                    </a>
                                    <!-- <a class="mt-2" href="./retailer-edit-kyc">
                                        <img src="./images/off.png" alt="">
                                        RETAILER EDIT KYC
                                    </a> -->
                                    <a class="mt-2" href="./distributor">
                                        <img src="./images/off.png" alt="">
                                        DISTRIBUTOR KYC
                                    </a>
                                    <a class="mt-2" href="./authentication">
                                        <img src="./images/off.png" alt="">
                                        DSR ATTENDANCE
                                    </a>
                                    <a class="mt-2" href="./payout">
                                        <img src="./images/off.png" alt="">
                                        DSR PAYOUT
                                    </a>
                                    <a class="mt-2" href="./kyc-history">
                                        <img src="./images/off.png" alt="">
                                        DSR History</a>
                                    <a class="mt-2" href="./kyc-history">
                                        <img src="./images/on.png" alt="">
                                        RETAILER History
                                    </a>

                                    <a class="mt-2" href="./master-data">
                                        <img src="./images/off.png" alt="">
                                        MASTER DATA
                                    </a>
                                    <a class="mt-2" href="./kyc-status">
                                        <img src="./images/off.png" alt="">
                                        KYC STATUS
                                    </a>
                                    <!-- <a class="mt-2" href="./awsm-updation">
                                        <img src="./images/off.png" alt="">
                                        AWSM UPDATION
                                    </a> -->
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="card-body">


                        <div id="demo" class="collapse">
                            <!-- <div class="row">
                                <div class="col-4">
                                    <div class="dropdown color-btn m-1">
                                        <a type="button" class="btn  btn-outline-alternate custom-button  mr-3"
                                            id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                            aria-expanded="false">
                                            <img src="./images/arrow_down.png" width="10px" alt="">
                                            KYC History
                                        </a>
                                        <div class="dropdown-menu width-drop" aria-labelledby="dropdownMenuButton">
                                            <a class="dropdown-item" href="./kyc-history">DSR KYC History</a>
                                            <a class="dropdown-item" href="./retailer-history">RETAILER KYC
                                                History</a>
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                            <form action="./kyc-history">
                                <div class="row">

                                    <div class="col-2">

                                        <label for="Mobile" class="mr-sm-2">Mobile Number</label>

                                        <input type="tel" maxlength="10" class="form-control" id="mobile_no"
                                            placeholder="Mobile" name="Mobile" value="<%=QueryData.Mobile %>">

                                    </div>

                                    <div class="col-2">

                                        <label for="salesman_id" class="mr-sm-2">RETAILER ID</label>

                                        <input type="text" class="form-control" id="awsm_code"
                                            placeholder="retailer _id" name="salesman_id"
                                            value="<%=QueryData.salesman_id %>">

                                    </div>

                                    <div class="col-2">

                                        <label for="salesman_name" class="mr-sm-2">RETAILER NAME</label>

                                        <input type="text" class="form-control" id="awsm_name"
                                            placeholder="retailer_name" name="salesman_name"
                                            value="<%=QueryData.salesman_name %>">

                                    </div>

                                    <div class="col-2">

                                        <div class="ms-auto">

                                            <label for="salesman_type">SELECT KYC TYPE</label>

                                            <select name="salesman_type" class="form-control" id="salesman_type"
                                                placeholder="salesman_type" value="<%=QueryData.salesman_type %>">

                                                <option value=""> KYC Type </option>
                                                <option value="Awsm" <%=QueryData.salesman_type==='Awsm' ? 'selected'
                                                    : '' %>>DSR</option>
                                                <option value="Sda" <%=QueryData.salesman_type==='Sda' ? 'selected' : ''
                                                    %>>SDA</option>
                                                <option value="Psm" <%=QueryData.salesman_type==='Psm' ? 'selected' : ''
                                                    %>>PSM</option>>

                                            </select>

                                        </div>

                                    </div>

                                    <div class="col-2">

                                        <label for="AW-ID" class="mr-sm-2">Distributor ID</label>

                                        <input type="text" class="form-control" id="aw_code"
                                            placeholder="distributor_id" name="aw_code" value="<%=QueryData.aw_code %>">

                                    </div>

                                    <div class="col-2">

                                        <label for="AW-NAME" class="mr-sm-2">Distributor NAME</label>

                                        <input type="text" class="form-control" id="aw_name"
                                            placeholder="distributor_name" name="aw_name"
                                            value="<%=QueryData.aw_name %>">

                                    </div>



                                    <div class="col-2 mt-2">

                                        <label for="ASE-CODE" class="mr-sm-2">SO CODE</label>

                                        <input type="text" class="form-control" id="ase_code" placeholder="so_code"
                                            name="ase_code" value="<%=QueryData.ase_code %>">

                                    </div>

                                    <div class="col-2 mt-2">

                                        <label for="ASE-NAME" class="mr-sm-2">SO NAME</label>

                                        <input type="text" class="form-control" id="ase_name" placeholder="so_name"
                                            name="ase_name" value="<%=QueryData.ase_name %>">

                                    </div>

                                    <div class="col-2 mt-2">

                                        <label for="FROM" class="mr-sm-2">FROM</label>

                                        <input type="date" class="form-control" id="fromDate" placeholder="fromDate"
                                            name="fromDate" value="<%=QueryData.fromDate %>">
                                    </div>

                                    <div class="col-2 mt-2">

                                        <label for="TO" class="mr-sm-2">TO</label>

                                        <input type="date" class="form-control" id="toDate" placeholder="toDate"
                                            name="toDate" value="<%=QueryData.toDate %>">

                                    </div>

                                    <div class="col-2 mt-2">

                                        <div class="ms-auto">

                                            <label for="State">State </label>

                                            <select name="state" class="form-control" id="awsm_state"
                                                value="<%=QueryData.state %>">

                                                <option value="">Select State</option>

                                                <option value="Andra Pradesh" <%=QueryData.state==='Andra Pradesh'
                                                    ? 'selected' : '' %>>Andra Pradesh</option>

                                                <option value="Arunachal Pradesh"
                                                    <%=QueryData.state==='Arunachal Pradesh' ? 'selected' : '' %>
                                                    >Arunachal Pradesh

                                                </option>

                                                <option value="Assam" <%=QueryData.state==='Assam' ? 'selected' : '' %>
                                                    >Assam</option>

                                                <option value="Bihar" <%=QueryData.state==='Bihar' ? 'selected' : '' %>
                                                    >Bihar</option>

                                                <option value="Chhattisgarh" <%=QueryData.state==='Chhattisgarh'
                                                    ? 'selected' : '' %>>Chhattisgarh</option>

                                                <option value="Goa" <%=QueryData.state==='Goa' ? 'selected' : '' %>
                                                    >Goa
                                                </option>

                                                <option value="Gujarat" <%=QueryData.state==='Gujarat' ? 'selected' : ''
                                                    %>>Gujarat</option>

                                                <option value="Haryana" <%=QueryData.state==='Haryana' ? 'selected' : ''
                                                    %>>Haryana</option>

                                                <option value="Himachal Pradesh" <%=QueryData.state==='Himachal Pradesh'
                                                    ? 'selected' : '' %>
                                                    >Himachal Pradesh

                                                </option>

                                                <option value="Jammu and Kashmir"
                                                    <%=QueryData.state==='Jammu and Kashmir' ? 'selected' : '' %>
                                                    >Jammu
                                                    and Kashmir

                                                </option>

                                                <option value="Jharkhand" <%=QueryData.state==='Jharkhand' ? 'selected'
                                                    : '' %>>Jharkhand</option>

                                                <option value="Karnataka" <%=QueryData.state==='Karnataka' ? 'selected'
                                                    : '' %>>Karnataka</option>

                                                <option value="Kerala" <%=QueryData.state==='Kerala' ? 'selected' : ''
                                                    %>>Kerala</option>

                                                <option value="Madya Pradesh" <%=QueryData.state==='Madya Pradesh'
                                                    ? 'selected' : '' %>>Madhya Pradesh</option>

                                                <option value="Maharashtra" <%=QueryData.state==='Maharashtra'
                                                    ? 'selected' : '' %>>Maharashtra</option>

                                                <option value="Manipur" <%=QueryData.state==='Manipur' ? 'selected' : ''
                                                    %>>Manipur</option>

                                                <option value="Meghalaya" <%=QueryData.state==='Meghalaya' ? 'selected'
                                                    : '' %>>Meghalaya</option>

                                                <option value="Mizoram" <%=QueryData.state==='Mizoram' ? 'selected' : ''
                                                    %>>Mizoram</option>

                                                <option value="Nagaland" <%=QueryData.state==='Nagaland' ? 'selected'
                                                    : '' %>>Nagaland</option>

                                                <option value="Orissa" <%=QueryData.state==='Orissa' ? 'selected' : ''
                                                    %>>Orissa</option>

                                                <option value="Punjab" <%=QueryData.state==='Punjab' ? 'selected' : ''
                                                    %>>Punjab</option>

                                                <option value="Rajasthan" <%=QueryData.state==='Rajasthan' ? 'selected'
                                                    : '' %>>Rajasthan</option>

                                                <option value="Sikkim" <%=QueryData.state==='Sikkim' ? 'selected' : ''
                                                    %>>Sikkim</option>

                                                <option value="Tamil Nadu" <%=QueryData.state==='Tamil Nadu'
                                                    ? 'selected' : '' %>>Tamil Nadu</option>

                                                <option value="Telangana" <%=QueryData.state==='Telangana' ? 'selected'
                                                    : '' %>>Telangana</option>

                                                <option value="Tripura" <%=QueryData.state==='Tripura' ? 'selected' : ''
                                                    %>>Tripura</option>

                                                <option value="Uttaranchal" <%=QueryData.state==='Uttaranchal'
                                                    ? 'selected' : '' %>>Uttaranchal</option>

                                                <option value="Uttar Pradesh" <%=QueryData.state==='Uttar Pradesh'
                                                    ? 'selected' : '' %>>Uttar Pradesh</option>

                                                <option value="West Bengal" <%=QueryData.state==='West Bengal'
                                                    ? 'selected' : '' %>>West Bengal</option>

                                                <option value="UNION Territories"
                                                    <%=QueryData.state==='UNION Territories' ? 'selected' : '' %>
                                                    >UNION
                                                    Territories

                                                </option>

                                                <option value="Andaman and Nicobar Islands"
                                                    <%=QueryData.state==='Andaman and Nicobar Islands' ? 'selected' : ''
                                                    %>>Andaman and

                                                    Nicobar Islands</option>

                                                <option value="Chandigarh" <%=QueryData.state==='Chandigarh'
                                                    ? 'selected' : '' %>>Chandigarh</option>

                                                <option value="Dadar and Nagar Haveli"
                                                    <%=QueryData.state==='Dadar and Nagar Haveli' ? 'selected' : '' %>
                                                    >Dadar and Nagar

                                                    Haveli</option>

                                                <option value="Daman and Diu" <%=QueryData.state==='Daman and Diu'
                                                    ? 'selected' : '' %>>Daman and Diu</option>

                                                <option value="Delhi" <%=QueryData.state==='Delhi' ? 'selected' : '' %>
                                                    >Delhi</option>

                                                <option value="Lakshadeep" <%=QueryData.state==='Lakshadeep'
                                                    ? 'selected' : '' %>>Lakshadeep</option>

                                                <option value="Pondicherry" <%=QueryData.state==='Pondicherry'
                                                    ? 'selected' : '' %>>Pondicherry</option>

                                            </select>
                                        </div>

                                    </div>

                                    <div class="col-2 mt-2">

                                        <div class="ms-auto">

                                            <label for="city">City </label>

                                            <select name="city" class="form-control" id="awsm_city">
                                                <option value="">Select City</option>
                                                <% awsmCity.forEach((city)=> { %>
                                                    <option value="<%= city.awsm_city %>"
                                                        <%=QueryData.city===city.awsm_city ? 'selected' : '' %>
                                                        ><%= city.awsm_city %>
                                                    </option>
                                                    <% }) %>
                                            </select>

                                        </div>

                                    </div>

                                </div>

                                <div class="text-right mb-3">
                                    <!-- <a href="./kyc-history"
                                        class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</a> -->
                                    <button type="reset"
                                        class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</button>

                                    <button type="submit"
                                        class="btn-shadow  btn btn-primary custom-btn  btn-lg mt-3">Apply</button>

                                </div>
                            </form>
                        </div>
                        <div class="table table-striped table-bordered table-responsive dataTable no-footer">
                            <div class="height-tabel">
                                <div class="table-header-new overflow"
                                    style="width: 160px !important;top: 200px;bottom: 0;right: 0;left: 20px;">
                                    <ul class="table-ul">
                                        <li style="width: 162px;padding:17px 18px 18px 17px;"
                                            class="header-contents-new">CREATE DATE</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">KYC TYPE</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">SO EMAIL ID</li>
                                        <li style="width: 162px;padding-left: 18px;padding: 17px 18px 18px 17px;;"
                                            class="header-contents-new">SO CODE</li>
                                        <li style="width: 162px;padding:17px 18px 18px 17px;"
                                            class="header-contents-new">SO NAME</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">RETAILER ID</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">RETAILER NAME</li>


                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">Distributor ID</li>
                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">Distributor NAME</li>

                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">BENEFICIARY NAME</li>
                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">STATE NAME</li>
                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">CITY NAME</li>
                                        <li style="width: 162px;padding: 17px 18px 18px 17px;"
                                            class="header-contents-new">ADDRESS</li>
                                        <li style="width: 162px;padding: 17px 26px 26px 17px;"
                                            class="header-contents-new">SALESMAN PHOTO</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">BANK A/C NO.</li>
                                        <li style="width: 162px;padding: 17px 20px 20px 17px;"
                                            class="header-contents-new">IFSC CODE</li>
                                        <li style="width: 162px;padding: 17px 30px 30px 17px;"
                                            class="header-contents-new">CHEQUE IMAGE</li>
                                        <li style="width: 162px;padding: 17px 20px 20px 17px;"
                                            class="header-contents-new">BANK NAME</li>
                                        <li style="width: 162px;padding: 17px 26px 26px 17px;"
                                            class="header-contents-new">PHOTO ID IMAGE</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">MOBILE NO</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">CALLING COUNT</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">CALLING STATUS</li>
                                        <li style="padding: 17px 10px 7px 17px;width: 162px; font-size: 10px;"
                                            class="header-contents-new">VALIDATION CALLING REMARK</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">KYC STATUS</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px; font-size: 10px;"
                                            class="header-contents-new">KYC REJECTION REASON</li>
                                        <li style="padding: 17px 18px 18px 17px; width: 162px;"
                                            class="header-contents-new">REMARKS</li>
                                        <li style="padding: 17px 18px 18px 17px; width: 162px;"
                                            class="header-contents-new">VERIFICATION DATE</li>
                                        <li style="padding:17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">GENDER</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">DOB</li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">CHANNEL TYPE</li>

                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">MODIFICATION DATE
                                        </li>
                                        <li style="padding: 17px 18px 18px 17px;width: 162px;"
                                            class="header-contents-new">NEW MODIFICATION DATE
                                        </li>
                                    </ul>

                                </div>
                                <% kycHistoryData.forEach(function(data) { %>
                                    <div class="table-new "
                                        style="width: 180px !important;top: 200px;bottom: 0;right: 0;left: 20px;">
                                        <form action="" method="post">

                                            <ul class="table-tabel">
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="Create Date"
                                                        class="form-control"
                                                        value="<%= (data.created_on)? data.created_on.toLocaleDateString('en-IN'): '' %>"
                                                        readonly=""></li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="FRESH"
                                                        class="form-control" value="<%= data.kyc_type %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.ase_email %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.ase_employee_code %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.ase_name %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="Create Date"
                                                        class="form-control" value="<%= data.awsm_code %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.awsm_name %>" readonly="">
                                                </li>

                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="AWSM"
                                                        class="form-control" value="<%= data.aw_code %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.aw_name %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.beneficiary_name %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.awsm_state %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.awsm_city %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.address %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new tabel-img">
                                                    <div class="tabel-img">
                                                        <a target="_blank">
                                                            <img width="100" height="50" src="<%= data.photo %>"
                                                                onclick="getImage(this);">
                                                            <input type="hidden" value="<%= data.photo %>" name="photo">
                                                        </a>
                                                    </div>
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.bank_account_no %>"
                                                        readonly=""></li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.ifsc_code %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><a target="_blank">
                                                        <img width="100" height="50" src="<%= data.bank_cheque %>"
                                                            onclick="getImage(this);">
                                                        <input type="hidden" value="<%= data.bank_cheque %>"
                                                            name="bank_cheque">
                                                    </a></li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.bank_name %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><a target="_blank">
                                                        <img width="100" height="50" src="<%= data.photo_id %>"
                                                            onclick="getImage(this);">
                                                    </a></li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="mobile_no"
                                                        class="form-control" value="<%= data.mobile_no %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name="calling_count"
                                                        class="form-control" value="<%= data.calling_count %>"
                                                        readonly=""></li>

                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control btn-succes"
                                                        value="<%= data.calling_status %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control " value="<%= data.calling_remarks %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control btn-succes" value="<%= data.status %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text"
                                                        name="kyc_rejection_reason" class="form-control "
                                                        value="<%= data.wip_remarks %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control " value="<%= data.approved_comment %>"
                                                        readonly="">
                                                </li>
                                                <!-- <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control"
                                                        value="<%= (data.approved_on)? data.approved_on.toLocaleDateString('en-IN'): '' %>"
                                                        readonly="">
                                                </li> -->
                                                <li style="width: 162px; padding: 7px 16px 7px 16px"
                                                    class="header-contents-new">
                                                    <input type="text" name="" class="form-control" readonly="" value="<%= 
                                                        (() => {
                                                            console.log('kyc_type:', data.kyc_type);
                                                            
                                                
                                                            if (data.kyc_type === 'FRESH') {
                                                                return data.approved_on ? data.approved_on.toLocaleDateString('en-IN') : '';
                                                            } else if (data.kyc_type === 'RE-KYC') {
                                                                console.log('re_kyc_edit_on:-', data.re_kyc_edit_on);
                                                                return data.re_kyc_edit_on ? data.re_kyc_edit_on.toLocaleDateString('en-IN') : '';
                                                            } else if (data.kyc_type === 'Replace-KYC') {
                                                                return data.replace_kyc_edit_on ? data.replace_kyc_edit_on.toLocaleDateString('en-IN') : '';
                                                            } else if (data.kyc_type === 'Edited-KYC') {
                                                                return data.approved_kyc_edit_on ? data.approved_kyc_edit_on.toLocaleDateString('en-IN') : '';
                                                            } else {
                                                                return '';
                                                            }
                                                        })()
                                                    %>">
                                                </li>

                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.gender %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control"
                                                        value="<%= (data.dob)? data.dob.toLocaleDateString('en-IN'): '' %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control" value="<%= data.channel %>" readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="button" name=""
                                                        class="form-control"
                                                        value="<%= (data.update_timestamp)? data.update_timestamp.toLocaleDateString('en-IN'): '' %>"
                                                        readonly="">
                                                </li>
                                                <li style="width: 162px;padding: 7px 16px 7px 16px"
                                                    class="header-contents-new"><input type="text" name=""
                                                        class="form-control"
                                                        value="<%= (data.update_old_modification_date)? data.update_old_modification_date.toLocaleDateString('en-IN'): '' %>"
                                                        readonly="">
                                                </li>
                                            </ul>

                                        </form>
                                    </div>
                                    <% }); %>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="imageModal" tabindex="-1" role="dialog">
        <div class="modal-dialog  modal-top " role="document">
            <div class="modal-content">
                <div class="modal-header">

                    <button type="button" class="close" onclick="modal_close()" data-bs-dismiss="modal"
                        fdprocessedid="n6zi5o">×</button>
                </div>
                <div class="modal-body">
                    <img class="modal-content1" id="getImage-id" width="100px">
                </div>

            </div>
        </div>
    </div>
    <script>
        function getImage(data) {

            let image = data.src;
            let element = document.getElementById('getImage-id');
            element.setAttribute('src', image)
            let image_modal = document.getElementById('imageModal');

            image_modal.style.display = "block";


        }
        function modal_close() {
            let image_modal = document.getElementById('imageModal');
            image_modal.style.display = "none";
        }
    </script>
    <script>
        function fnExcelReport(file, mobile_no, awsm_code, awsm_name, salesman_type, aw_code, aw_name, ase_code, ase_name, fromDate, toDate, awsm_state, awsm_city) {

            fetch(`/kyc-history/export?mobile_no=${mobile_no}&awsm_code=${awsm_code}&awsm_name=${awsm_name}&salesman_type=${salesman_type}&aw_code=${aw_code}&aw_name=${aw_name}&ase_code=${ase_code}&ase_name=${ase_name}&fromDate=${fromDate}&toDate=${toDate}&awsm_state=${awsm_state}&awsm_city=${awsm_city}`)
                .then((res) => res.json())
                .then((data) => {
                    data.forEach((item) => {
                        item.dob = formatDate(item.dob);
                        item.created_on = formatDate(item.created_on);
                        item.approved_on = formatDate(item.approved_on)
                        item.replace_kyc_edit_on = formatDate(item.replace_kyc_edit_on);
                        item.re_kyc_edit_on = formatDate(item.re_kyc_edit_on);
                        item.approved_kyc_edit_on = formatDate(item.approved_kyc_edit_on);
                        item.update_old_modification_date = formatDate(item.update_old_modification_date);
                        item.insert_timestamp = formatDate(item.insert_timestamp);
                        item.update_timestamp = formatDate(item.update_timestamp);
                        item.bank_account_no = formatBankAccount(item.bank_account_no);
                    });

                    const csvContent = createCSV(data);

                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:csv;charset=utf-8, ' + encodeURIComponent(csvContent));
                    element.setAttribute('download', file);

                    document.body.appendChild(element);

                    element.click();

                    document.body.removeChild(element);
                });
        }

        function formatDate(dateString) {
            if (dateString !== null) {
                const date = new Date(dateString);
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            } else {
                return null
            }
        }

        function formatBankAccount(accountNumber) {
            return accountNumber.match(/.{1,4}/g).join(' ');
        }

        function createCSV(data) {
            const headers = [
                "CREATE DATE",
                "KYC TYPE",
                "ASE EMAIL ID",
                "ASE CODE",
                "ASE NAME",
                "SALESMAN ID",
                "SALESMAN NAME",
                "SALESMAN TYPE",
                "VIKAS ID",
                "HQ LOCATION",
                "DISTRICT",
                "TEHSIL/SUB DISTRICT",
                "HQ TOWN",
                "HQ TOWN CENSUS CODE",
                "MV",
                "AW1 ID",
                "AW1 NAME",
                "AW2 ID",
                "AW3 ID",
                "AW4 ID",
                "AW5 ID",
                "BENEFICIARY NAME",
                "STATE NAME",
                "CITY NAME",
                "ADDRESS",
                "SALESMAN PHOTO",
                "BANK A/C NO.",
                "IFSC CODE",
                "CHEQUE IMAGE",
                "BANK NAME",
                "PHOTO ID IMAGE",
                "MOBILE NO",
                "CALLING COUNT",
                "CALLING STATUS",
                "VALIDATION CALLING REMARK",
                "KYC STATUS",
                "KYC REJECTION REASON",
                "WIP REMARKS",
                "VERIFICATION DATE",
                "GENDER",
                "DOB",
                "CHANNEL TYPE",
                "MODIFIED DATE",
                "NEW MODIFICATION DATE"
            ]

            function dateFun(item) {
                console.log(item);
                switch (item.kyc_type) {
                    case 'FRESH':
                        return item.approved_on;
                    case 'RE-KYC':
                        return item.re_kyc_edit_on;
                    case 'Replace-KYC':
                        return item.replace_kyc_edit_on;
                    case 'Edited-KYC':
                        return item.approved_kyc_edit_on;
                    default:
                        return null;
                }
            }
            console.log(data[0]);
            const flattenData = data.map(item => ({
                "CREATE DATE": item.created_on,
                "KYC TYPE": item.kyc_type,
                "ASE EMAIL ID": item.ase_email,
                "ASE CODE": item.ase_employee_code,
                "ASE NAME": item.ase_name,
                "SALESMAN ID": item.awsm_code,
                "SALESMAN NAME": item.awsm_name,
                "SALESMAN TYPE": item.salesman_type,
                "VIKAS ID": "",
                "HQ LOCATION": "",
                "DISTRICT": "",
                "TEHSIL/SUB DISTRICT": "",
                "HQ TOWN": "",
                "HQ TOWN CENSUS CODE": "",
                "MV": "",
                "AW1 ID": item.aw_code,
                "AW1 NAME": item.aw_name,
                "AW2 ID": " ",
                "AW3 ID": " ",
                "AW4 ID": " ",
                "AW5 ID": " ",
                "BENEFICIARY NAME": item.beneficiary_name,
                "STATE NAME": item.awsm_state,
                "CITY NAME": item.awsm_city,
                "ADDRESS": item.address,
                "SALESMAN PHOTO": item.photo,
                "BANK A/C NO.": item.bank_account_no,
                "IFSC CODE": item.ifsc_code,
                "CHEQUE IMAGE": item.bank_cheque,
                "BANK NAME": item.bank_name,
                "PHOTO ID IMAGE": item.photo_id,
                "MOBILE NO": item.mobile_no,
                "CALLING COUNT": item.calling_count,
                "CALLING STATUS": item.calling_status,
                "VALIDATION CALLING REMARK": item.calling_remarks,
                "KYC STATUS": item.status,
                "KYC REJECTION REASON": item.wip_remarks,
                "WIP REMARKS": item.approved_comment,
                "VERIFICATION DATE": dateFun(item),
                "GENDER": item.gender,
                "DOB": item.dob,
                "CHANNEL TYPE": item.channel,
                "MODIFIED DATE": (item.update_timestamp ? item.update_timestamp : ''),
                "NEW MODIFICATION DATE": (item.update_old_modification_date ? item.update_old_modification_date : "")
            }));

            const replacer = (key, value) => (value === null ? "" : value);
            const csvContent = [headers.join(","), ...flattenData.map(row => headers.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(","))].join("\r\n");
            return csvContent;

            // const replacer = (key, value) => value === null ? '' : value;
            // const header = Object.keys(data[0])
            // const csvContent = [
            //     header.join(','),
            //     ...data.map(row => header.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(','))
            // ].join('\r\n');
            // return csvContent;
        }

        document.getElementById("btnExport")
            .addEventListener("click", function () {
                var filename = "kyc_history.csv";
                var mobile_no = document.getElementById("mobile_no").value;
                var awsm_code = document.getElementById("awsm_code").value;
                var awsm_name = document.getElementById("awsm_name").value;
                var salesman_type = document.getElementById("salesman_type").value;
                var aw_code = document.getElementById("aw_code").value;
                var aw_name = document.getElementById("aw_name").value;
                var ase_code = document.getElementById("ase_code").value;
                var ase_name = document.getElementById("ase_name").value;
                var fromDate = document.getElementById("fromDate").value;
                var toDate = document.getElementById("toDate").value;
                var awsm_state = document.getElementById("awsm_state").value;
                var awsm_city = document.getElementById("awsm_city").value;
                fnExcelReport(filename, mobile_no, awsm_code, awsm_name, salesman_type, aw_code, aw_name, ase_code, ase_name, fromDate, toDate, awsm_state, awsm_city);
            }, false);
    </script>

    <!-- <script>

        var modal = document.getElementById("imageModal");
        var modalImg = document.getElementById("modalImage");
        var img = document.getElementById("image");
        var img1 = document.getElementById("image1");
        var img2 = document.getElementById("image2");

        img.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
        }
        img1.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
        }
        img2.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
        }
        var closeBtn = document.getElementsByClassName("close")[0];
        closeBtn.onclick = function () {
            modal.style.display = "none";
        }


        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

    </script> -->

    <%- include("../shared/footer"); %>
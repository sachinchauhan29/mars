<%- include("../shared/header"); %>

    <div class="app-page-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                <!-- <div class="page-title-icon">
                    <i class=" fas fa-sort-amount-up icon-gradient bg-mean-fruit">
                    </i>
                </div> -->
                <div>
                    <b> KYC STATUS</b>
                </div>
            </div>

        </div>
    </div>

    <% if(user.role==='admin' ){%>
        <div class="row">
            <div class="col-md-12 col-lg-12 mx-auto">
                <div class="mb-3 ">
                    <div class="card">
                        <div class="card-header-tab card-header-tab-animation card-header">
                            <div class="row">
                                <div class=" col-lg-8 col-md-8  col-12">
                                    <h5><b>SELECT REPORT TYPE</b></h5>
                                </div>
                                <div class="col-lg-4 col-lg-4 col-12 text-right">
                                    <button id="btnExport" class="btn  btn-outline-alternate custom-button  mr-3"><i
                                            class="metismenu-icon fas fa-arrow-alt-circle-down mr-2"></i>Download</button>
                                    <button class="btn-shadow  btn btn-primary custom-btn  btn-lg"
                                        data-toggle="collapse" data-target="#demo"><i
                                            class='fas fa-filter mr-2'></i>Filter</button>

                                </div>
                                <div class=" mt-3 px-xl-2 col-12">
                                    <div class="dis-grid">
                                        <a class="mt-2" href="./kyc">
                                            <img src="./images/off.png" alt="">
                                            DSR Kyc
                                        </a>
                                        <a class="mt-2" href="./edit-kyc-data">
                                            <img src="./images/off.png" alt="">
                                            DSR EDIT KYC
                                        </a>
                                        <a class="mt-2" href="./retailer">
                                            <img src="./images/off.png" alt="">
                                            RETAILER KYC
                                        </a>
                                        <!-- <a class="mt-2" href="./retailer-edit-kyc">
                                            <img src="./images/off.png" alt="">
                                            RETAILER EDIT KYC
                                        </a> -->
                                        <a class="mt-2" href="./distributor">
                                            <img src="./images/off.png" alt="">
                                            DISTRIBUTOR KYC
                                        </a>
                                        <a class="mt-2" href="./dsr_attendance">
                                            <img src="./images/off.png" alt="">
                                            DSR ATTENDANCE
                                        </a>
                                        <a class="mt-2" href="./payout">
                                            <img src="./images/off.png" alt="">
                                            DSR PAYOUT
                                        </a>
                                        <a class="mt-2" href="./kyc-history">
                                            <img src="./images/off.png" alt="">
                                            DSR KYC History</a>
                                        <a class="mt-2" href="./retailer-history">
                                            <img src="./images/off.png" alt="">
                                            RETAILER KYC History
                                        </a>
                                        <a class="mt-2" href="./master-data">
                                            <img src="./images/off.png" alt="">
                                            MASTER DATA
                                        </a>
                                        <a class="mt-2" href="./retailerkycstatus">
                                            <img src="./images/on.png" alt="">
                                            KYC STATUS
                                        </a>
                                        <!-- <a class="mt-2" href="./awsm-updation">
                                            <img src="./images/off.png" alt="">
                                            AWSM UPDATION
                                        </a> -->

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="m-2">
                                <a class="mt-2" href="./kyc-status">
                                    <img src="./images/off.png" alt="">
                                    DSR KYC STATUS
                                </a>
                                <a class="mt-2" href="./retailerkycstatus">
                                    <img src="./images/on.png" alt="">
                                    RETAILER KYC STATUS
                                </a>
                            </div>
                            <div id="demo" class="collapse">
                                <form action="./retailerkycstatus">
                                    <div class="row">

                                        <div class="col-3">

                                            <label for="salesman_id" class="mr-sm-2">RETAILER ID</label>

                                            <input type="text" class="form-control" id="awsm_code"
                                                placeholder="RETAILER_id" name="salesman_id"
                                                value="<%=QueryData.salesman_id %>">

                                        </div>
                                        <!-- <div class="col-2">

                                            <div class="ms-auto">

                                                <label for="salesman_type">SELECT KYC TYPE</label>

                                                <select name="salesman_type" class="form-control" id="salesman_type"
                                                    placeholder="salesman_type" value="<%=QueryData.salesman_type %>">

                                                    <option value=""> KYC Type </option>
                                                    <option value="Awsm" <%=QueryData.salesman_type==='Awsm'
                                                        ? 'selected' : '' %>>DSR</option>
                                                    <option value="Sda" <%=QueryData.salesman_type==='Sda' ? 'selected'
                                                        : '' %>>SDA</option>
                                                    <option value="Psm" <%=QueryData.salesman_type==='Psm' ? 'selected'
                                                        : '' %>>PSM</option>>

                                                </select>

                                            </div>

                                        </div>-->
                                        <div class="col-3">
                                            <div class="ms-auto">
                                                <label for="Month">Month </label>
                                                <select name="month" class="form-control" id="Month">
                                                    <option value="">Select Month</option>
                                                    <option value="January" <%=QueryData.month==='January' ? 'selected'
                                                        : '' %>>January</option>
                                                    <option value="February" <%=QueryData.month==='February'
                                                        ? 'selected' : '' %>>February</option>
                                                    <option value="March" <%=QueryData.month==='March' ? 'selected' : ''
                                                        %>
                                                        >March</option>
                                                    <option value="April" <%=QueryData.month==='April' ? 'selected' : ''
                                                        %>
                                                        >April</option>
                                                    <option value="May" <%=QueryData.month==='May' ? 'selected' : '' %>
                                                        >May
                                                    </option>
                                                    <option value="June" <%=QueryData.month==='June' ? 'selected' : ''
                                                        %>
                                                        >June</option>
                                                    <option value="July" <%=QueryData.month==='July' ? 'selected' : ''
                                                        %>
                                                        >July</option>
                                                    <option value="August" <%=QueryData.month==='August' ? 'selected'
                                                        : '' %>>August</option>
                                                    <option value="September" <%=QueryData.month==='September'
                                                        ? 'selected' : '' %>>September</option>
                                                    <option value="October" <%=QueryData.month==='October' ? 'selected'
                                                        : '' %>>October</option>
                                                    <option value="November" <%=QueryData.month==='November'
                                                        ? 'selected' : '' %>>November</option>
                                                    <option value="December" <%=QueryData.month==='December'
                                                        ? 'selected' : '' %>>December</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="col-3">
                                            <div class="ms-auto">
                                                <label for="Year">Year </label>
                                                <select name="year" class="form-control" id="Year">
                                                    <option value="">Select Year</option>
                                                    <option value="2024" <%=QueryData.year==='2024' ? 'selected' : '' %>
                                                        >2024</option>
                                                    <option value="2022" <%=QueryData.year==='2023' ? 'selected' : '' %>
                                                        >2023</option>
                                                    <option value="2022" <%=QueryData.year==='2022' ? 'selected' : '' %>
                                                        >2022</option>

                                                </select>
                                            </div>
                                        </div>


                                        <div class="col-3">

                                            <div class="ms-auto">

                                                <label for="State">State </label>

                                                <select name="state" class="form-control" id="awsm_state"
                                                    value="<%=QueryData.state %>">

                                                    <option value="">Select State</option>

                                                    <option value="Andra Pradesh" <%=QueryData.state==='Andra Pradesh'
                                                        ? 'selected' : '' %>
                                                        >Andra Pradesh</option>

                                                    <option value="Arunachal Pradesh"
                                                        <%=QueryData.state==='Arunachal Pradesh' ? 'selected' : '' %>
                                                        >Arunachal Pradesh

                                                    </option>

                                                    <option value="Assam" <%=QueryData.state==='Assam' ? 'selected' : ''
                                                        %>
                                                        >Assam</option>

                                                    <option value="Bihar" <%=QueryData.state==='Bihar' ? 'selected' : ''
                                                        %>
                                                        >Bihar</option>

                                                    <option value="Chhattisgarh" <%=QueryData.state==='Chhattisgarh'
                                                        ? 'selected' : '' %>>Chhattisgarh</option>

                                                    <option value="Goa" <%=QueryData.state==='Goa' ? 'selected' : '' %>
                                                        >Goa
                                                    </option>

                                                    <option value="Gujarat" <%=QueryData.state==='Gujarat' ? 'selected'
                                                        : '' %>>Gujarat</option>

                                                    <option value="Haryana" <%=QueryData.state==='Haryana' ? 'selected'
                                                        : '' %>>Haryana</option>

                                                    <option value="Himachal Pradesh"
                                                        <%=QueryData.state==='Himachal Pradesh' ? 'selected' : '' %>
                                                        >Himachal Pradesh

                                                    </option>

                                                    <option value="Jammu and Kashmir"
                                                        <%=QueryData.state==='Jammu and Kashmir' ? 'selected' : '' %>
                                                        >Jammu
                                                        and Kashmir

                                                    </option>

                                                    <option value="Jharkhand" <%=QueryData.state==='Jharkhand'
                                                        ? 'selected' : '' %>>Jharkhand</option>

                                                    <option value="Karnataka" <%=QueryData.state==='Karnataka'
                                                        ? 'selected' : '' %>>Karnataka</option>

                                                    <option value="Kerala" <%=QueryData.state==='Kerala' ? 'selected'
                                                        : '' %>>Kerala</option>

                                                    <option value="Madya Pradesh" <%=QueryData.state==='Madya Pradesh'
                                                        ? 'selected' : '' %>
                                                        >Madhya Pradesh</option>

                                                    <option value="Maharashtra" <%=QueryData.state==='Maharashtra'
                                                        ? 'selected' : '' %>>Maharashtra</option>

                                                    <option value="Manipur" <%=QueryData.state==='Manipur' ? 'selected'
                                                        : '' %>>Manipur</option>

                                                    <option value="Meghalaya" <%=QueryData.state==='Meghalaya'
                                                        ? 'selected' : '' %>>Meghalaya</option>

                                                    <option value="Mizoram" <%=QueryData.state==='Mizoram' ? 'selected'
                                                        : '' %>>Mizoram</option>

                                                    <option value="Nagaland" <%=QueryData.state==='Nagaland'
                                                        ? 'selected' : '' %>>Nagaland</option>

                                                    <option value="Orissa" <%=QueryData.state==='Orissa' ? 'selected'
                                                        : '' %>>Orissa</option>

                                                    <option value="Punjab" <%=QueryData.state==='Punjab' ? 'selected'
                                                        : '' %>>Punjab</option>

                                                    <option value="Rajasthan" <%=QueryData.state==='Rajasthan'
                                                        ? 'selected' : '' %>>Rajasthan</option>

                                                    <option value="Sikkim" <%=QueryData.state==='Sikkim' ? 'selected'
                                                        : '' %>>Sikkim</option>

                                                    <option value="Tamil Nadu" <%=QueryData.state==='Tamil Nadu'
                                                        ? 'selected' : '' %>>Tamil Nadu</option>

                                                    <option value="Telangana" <%=QueryData.state==='Telangana'
                                                        ? 'selected' : '' %>>Telangana</option>

                                                    <option value="Tripura" <%=QueryData.state==='Tripura' ? 'selected'
                                                        : '' %>>Tripura</option>

                                                    <option value="Uttaranchal" <%=QueryData.state==='Uttaranchal'
                                                        ? 'selected' : '' %>>Uttaranchal</option>

                                                    <option value="Uttar Pradesh" <%=QueryData.state==='Uttar Pradesh'
                                                        ? 'selected' : '' %>
                                                        >Uttar Pradesh</option>

                                                    <option value="West Bengal" <%=QueryData.state==='West Bengal'
                                                        ? 'selected' : '' %>>West Bengal</option>

                                                    <option value="UNION Territories"
                                                        <%=QueryData.state==='UNION Territories' ? 'selected' : '' %>
                                                        >UNION
                                                        Territories

                                                    </option>

                                                    <option value="Andaman and Nicobar Islands"
                                                        <%=QueryData.state==='Andaman and Nicobar Islands' ? 'selected'
                                                        : '' %>>Andaman and

                                                        Nicobar Islands</option>

                                                    <option value="Chandigarh" <%=QueryData.state==='Chandigarh'
                                                        ? 'selected' : '' %>>Chandigarh</option>

                                                    <option value="Dadar and Nagar Haveli"
                                                        <%=QueryData.state==='Dadar and Nagar Haveli' ? 'selected' : ''
                                                        %>
                                                        >Dadar and Nagar

                                                        Haveli</option>

                                                    <option value="Daman and Diu" <%=QueryData.state==='Daman and Diu'
                                                        ? 'selected' : '' %>
                                                        >Daman and Diu</option>

                                                    <option value="Delhi" <%=QueryData.state==='Delhi' ? 'selected' : ''
                                                        %>
                                                        >Delhi</option>

                                                    <option value="Lakshadeep" <%=QueryData.state==='Lakshadeep'
                                                        ? 'selected' : '' %>>Lakshadeep</option>

                                                    <option value="Pondicherry" <%=QueryData.state==='Pondicherry'
                                                        ? 'selected' : '' %>>Pondicherry</option>

                                                </select>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="text-right mb-3">
                                        <!-- <a href="./retailerkycstatus"
                                            class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</a> -->
                                        <button type="reset"
                                            class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</button>

                                        <button type="submit"
                                            class="btn-shadow  btn btn-primary custom-btn  btn-lg mt-3">Apply</button>

                                    </div>
                                </form>
                            </div>

                            <div>
                                <table id="exampless" class="table table-striped table-bordered table-responsive"
                                    cellspacing="0">
                                    <thead>

                                        <tr>
                                            <th class="tabel-width">MONTH</th>
                                            <th class="tabel-width">RETAILER CODE</th>
                                            <th class="tabel-width">RETAILER NAME</th>
                                            <th class="tabel-width">RETAILER TYPE</th>
                                            <th class="tabel-width">KYC DATE</th>
                                            <th class="tabel-width">VERIFICATION DATE</th>
                                            <th class="tabel-width">ATTENDANCE DATE</th>
                                            <th class="tabel-width">STATUS</th>
                                            <th class="tabel-width">MODIFIED DATE</th>
                                            <th class="tabel-width">CHANNEL TYPE</th>
                                        </tr>
                                    </thead>


                                    <tbody>
                                        <% KYCStatusData.forEach((data)=> { %>
                                            <tr>
                                                <td>
                                                    <%= data.month_name%>
                                                </td>
                                                <td>
                                                    <%= data.RetailerCode%>
                                                </td>
                                                <td>
                                                    <%= data.created_by%>
                                                </td>
                                                <td>
                                                    <%= data.SellerType%>
                                                </td>
                                                <td>
                                                    <%= data.created_on.toLocaleDateString('en-IN') %>
                                                </td>
                                                <td>
                                                    <% if (data.kyc_type==='FRESH' && data.status==='SUCCESS' ) { %>
                                                        <%= (data.approved_on)?
                                                            data.approved_on.toLocaleDateString('en-IN'):'' %>
                                                            <% } else if (data.kyc_type==='RE-KYC-Request' &&
                                                                data.status==='SUCCESS' ) { %>
                                                                <%= (data.replace_kyc_edit_on)?
                                                                    data.replace_kyc_edit_on.toLocaleDateString('en-IN')
                                                                    : '' %>
                                                                    <% } else if (data.kyc_type==='Edit-KYC-Request' &&
                                                                        data.status==='SUCCESS' ) { %>
                                                                        <%= data.approved_kyc_edit_on ?
                                                                            data.approved_kyc_edit_on.toLocaleDateString('en-IN'): ''
                                                                            %>
                                                                            <% } %>
                                                </td>
                                                <td>
                                                    <%= data.authentication_date%>
                                                </td>
                                                <td>
                                                    <%= data.Retailerkycstatus%>
                                                </td>
                                                <td>
                                                    <%= data.kyc_update_date?
                                                        data.kyc_update_date.toLocaleDateString('en-IN'):'' %>
                                                </td>
                                                <td data-order="1000">
                                                    <%= data.channel%>
                                                </td>
                                            </tr>
                                            <%})%>
                                    </tbody>

                                </table>

                                <div class="dataTables_paginate paging_simple_numbers" id="example_paginate">
                                    <a href="/retailerkycstatus?page=<%= currentPage - 1 %>"
                                        class="paginate_button previous <%= startPage === 1 ? 'disabled' : '' %>"
                                        aria-controls="example" data-dt-idx="0" tabindex="-1"
                                        id="example_previous">Previous</a>
                                    <span>
                                        <% for (let i=startPage; i <=endPage; i++) { %>
                                            <a href="/retailerkycstatus?page=<%=i%>" class="paginate_button current"
                                                aria-controls="example" data-dt-idx="<%=i %>" tabindex="0">
                                                <%= i %>
                                            </a>
                                            <% } %>
                                    </span>
                                    <a href="/retailerkycstatus?page=<%= (parseInt(currentPage) + 1) %>"
                                        class="paginate_button next <%= endPage === totalRows ? 'disabled' : '' %>"
                                        aria-controls="example" id="example_next">Next</a>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <%} else { %>
            <div class="row">
                <div class="col-md-12 col-lg-12 mx-auto">
                    <div class="mb-3 ">
                        <div class="card">
                            <div class="card-header-tab card-header-tab-animation card-header">
                                <div class="row">
                                    <div class=" col-lg-8 col-md-8  col-12">
                                        <h5><b>SELECT REPORT TYPE</b></h5>
                                    </div>
                                    <div class="col-lg-4 col-lg-4 col-12 text-right">
                                        <button class="btn  btn-outline-alternate custom-button  mr-3"><i
                                                class="metismenu-icon fas fa-arrow-alt-circle-down mr-2"></i>Download</button>
                                        <button class="btn-shadow  btn btn-primary custom-btn  btn-lg"
                                            data-toggle="collapse" data-target=""><i
                                                class='fas fa-filter mr-2'></i>Filter</button>

                                    </div>
                                    <div class=" mt-3 px-xl-2 col-12">
                                        <div class="dis-grid">
                                            <a class="mt-2" href="./kyc">
                                                <img src="./images/off.png" alt="">
                                                DSR Kyc
                                            </a>
                                            <a class="mt-2" href="./edit-kyc-data">
                                                <img src="./images/off.png" alt="">
                                                DSR EDIT KYC
                                            </a>
                                            <a class="mt-2" href="./retailer">
                                                <img src="./images/off.png" alt="">
                                                RETAILER KYC
                                            </a>
                                            <!-- <a class="mt-2" href="./retailer-edit-kyc">
                                            <img src="./images/off.png" alt="">
                                            RETAILER EDIT KYC
                                        </a> -->
                                            <a class="mt-2" href="./distributor">
                                                <img src="./images/off.png" alt="">
                                                DISTRIBUTOR KYC
                                            </a>
                                            <a class="mt-2" href="./dsr_attendance">
                                                <img src="./images/off.png" alt="">
                                                DSR ATTENDANCE
                                            </a>
                                            <a class="mt-2" href="./payout">
                                                <img src="./images/off.png" alt="">
                                                DSR PAYOUT
                                            </a>
                                            <a class="mt-2" href="./kyc-history">
                                                <img src="./images/off.png" alt="">
                                                DSR History</a>
                                            <a class="mt-2" href="./retailer-history">
                                                <img src="./images/off.png" alt="">
                                                RETAILER History
                                            </a>
                                            <a class="mt-2" href="./master-data">
                                                <img src="./images/off.png" alt="">
                                                MASTER DATA
                                            </a>
                                            <a class="mt-2" href="./retailerkycstatus">
                                                <img src="./images/on.png" alt="">
                                                KYC STATUS
                                            </a>
                                            <!-- <a class="mt-2" href="./awsm-updation">
                                                <img src="./images/off.png" alt="">
                                                AWSM UPDATION
                                            </a> -->

                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="card-body">
                                <div class="m-2">
                                    <a class="mt-2" href="./kyc-status">
                                        <img src="./images/off.png" alt="">
                                        DSR KYC STATUS
                                    </a>
                                    <a class="mt-2" href="./retailerkycstatus">
                                        <img src="./images/on.png" alt="">
                                        RETAILER KYC STATUS
                                    </a>
                                </div>
                                <div id="demo" class="collapse">
                                    <form action="./retailerkycstatus">
                                        <div class="row">

                                            <div class="col-3">

                                                <label for="salesman_id" class="mr-sm-2">SALESMAN ID</label>

                                                <input type="text" class="form-control" id="salesman_id"
                                                    placeholder="salesman_id" name="salesman_id"
                                                    value="<%=QueryData.salesman_id %>">

                                            </div>
                                            <div class="col-2">

                                                <div class="ms-auto">

                                                    <label for="salesman_type">SELECT SALESMAN TYPE</label>

                                                    <select name="salesman_type" class="form-control" id="salesman_type"
                                                        placeholder="salesman_type"
                                                        value="<%=QueryData.salesman_type %>">

                                                        <option value=""> Salesman Type </option>
                                                        <option value="Awsm" <%=QueryData.salesman_type==='Awsm'
                                                            ? 'selected' : '' %>>AWSM</option>
                                                        <option value="Sda" <%=QueryData.salesman_type==='Sda'
                                                            ? 'selected' : '' %>>SDA</option>
                                                        <option value="Psm" <%=QueryData.salesman_type==='Psm'
                                                            ? 'selected' : '' %>>PSM</option>>

                                                    </select>

                                                </div>

                                            </div>
                                            <div class="col-2">
                                                <div class="ms-auto">
                                                    <label for="Month">Month </label>
                                                    <select name="month" class="form-control" id="Month">
                                                        <option value="">Select Month</option>
                                                        <option value="January" <%=QueryData.month==='January'
                                                            ? 'selected' : '' %>>January</option>
                                                        <option value="February" <%=QueryData.month==='February'
                                                            ? 'selected' : '' %>>February</option>
                                                        <option value="March" <%=QueryData.month==='March' ? 'selected'
                                                            : '' %>
                                                            >March</option>
                                                        <option value="April" <%=QueryData.month==='April' ? 'selected'
                                                            : '' %>
                                                            >April</option>
                                                        <option value="May" <%=QueryData.month==='May' ? 'selected' : ''
                                                            %>>May
                                                        </option>
                                                        <option value="June" <%=QueryData.month==='June' ? 'selected'
                                                            : '' %>
                                                            >June</option>
                                                        <option value="July" <%=QueryData.month==='July' ? 'selected'
                                                            : '' %>
                                                            >July</option>
                                                        <option value="August" <%=QueryData.month==='August'
                                                            ? 'selected' : '' %>>August</option>
                                                        <option value="September" <%=QueryData.month==='September'
                                                            ? 'selected' : '' %>>September</option>
                                                        <option value="October" <%=QueryData.month==='October'
                                                            ? 'selected' : '' %>>October</option>
                                                        <option value="November" <%=QueryData.month==='November'
                                                            ? 'selected' : '' %>>November</option>
                                                        <option value="December" <%=QueryData.month==='December'
                                                            ? 'selected' : '' %>>December</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-2">
                                                <div class="ms-auto">
                                                    <label for="Year">Year </label>
                                                    <select name="year" class="form-control" id="Year">
                                                        <option value="">Select Year</option>
                                                        <option value="2023" <%=QueryData.year==='2023' ? 'selected'
                                                            : '' %>
                                                            >2023</option>
                                                        <option value="2022" <%=QueryData.year==='2022' ? 'selected'
                                                            : '' %>
                                                            >2022</option>
                                                        <option value="2021" <%=QueryData.year==='2021' ? 'selected'
                                                            : '' %>
                                                            >2021</option>
                                                        <option value="2020" <%=QueryData.year==='2020' ? 'selected'
                                                            : '' %>
                                                            >2020</option>
                                                    </select>
                                                </div>
                                            </div>


                                            <div class="col-2">

                                                <div class="ms-auto">

                                                    <label for="State">State </label>

                                                    <select name="state" class="form-control" id="State"
                                                        value="<%=QueryData.state %>">

                                                        <option value="">Select State</option>

                                                        <option value="Andra Pradesh"
                                                            <%=QueryData.state==='Andra Pradesh' ? 'selected' : '' %>
                                                            >Andra Pradesh</option>

                                                        <option value="Arunachal Pradesh"
                                                            <%=QueryData.state==='Arunachal Pradesh' ? 'selected' : ''
                                                            %>
                                                            >Arunachal Pradesh

                                                        </option>

                                                        <option value="Assam" <%=QueryData.state==='Assam' ? 'selected'
                                                            : '' %>
                                                            >Assam</option>

                                                        <option value="Bihar" <%=QueryData.state==='Bihar' ? 'selected'
                                                            : '' %>
                                                            >Bihar</option>

                                                        <option value="Chhattisgarh" <%=QueryData.state==='Chhattisgarh'
                                                            ? 'selected' : '' %>
                                                            >Chhattisgarh</option>

                                                        <option value="Goa" <%=QueryData.state==='Goa' ? 'selected' : ''
                                                            %>>Goa
                                                        </option>

                                                        <option value="Gujarat" <%=QueryData.state==='Gujarat'
                                                            ? 'selected' : '' %>>Gujarat</option>

                                                        <option value="Haryana" <%=QueryData.state==='Haryana'
                                                            ? 'selected' : '' %>>Haryana</option>

                                                        <option value="Himachal Pradesh"
                                                            <%=QueryData.state==='Himachal Pradesh' ? 'selected' : '' %>
                                                            >Himachal Pradesh

                                                        </option>

                                                        <option value="Jammu and Kashmir"
                                                            <%=QueryData.state==='Jammu and Kashmir' ? 'selected' : ''
                                                            %>>Jammu
                                                            and Kashmir

                                                        </option>

                                                        <option value="Jharkhand" <%=QueryData.state==='Jharkhand'
                                                            ? 'selected' : '' %>>Jharkhand</option>

                                                        <option value="Karnataka" <%=QueryData.state==='Karnataka'
                                                            ? 'selected' : '' %>>Karnataka</option>

                                                        <option value="Kerala" <%=QueryData.state==='Kerala'
                                                            ? 'selected' : '' %>>Kerala</option>

                                                        <option value="Madya Pradesh"
                                                            <%=QueryData.state==='Madya Pradesh' ? 'selected' : '' %>
                                                            >Madhya Pradesh</option>

                                                        <option value="Maharashtra" <%=QueryData.state==='Maharashtra'
                                                            ? 'selected' : '' %>
                                                            >Maharashtra</option>

                                                        <option value="Manipur" <%=QueryData.state==='Manipur'
                                                            ? 'selected' : '' %>>Manipur</option>

                                                        <option value="Meghalaya" <%=QueryData.state==='Meghalaya'
                                                            ? 'selected' : '' %>>Meghalaya</option>

                                                        <option value="Mizoram" <%=QueryData.state==='Mizoram'
                                                            ? 'selected' : '' %>>Mizoram</option>

                                                        <option value="Nagaland" <%=QueryData.state==='Nagaland'
                                                            ? 'selected' : '' %>>Nagaland</option>

                                                        <option value="Orissa" <%=QueryData.state==='Orissa'
                                                            ? 'selected' : '' %>>Orissa</option>

                                                        <option value="Punjab" <%=QueryData.state==='Punjab'
                                                            ? 'selected' : '' %>>Punjab</option>

                                                        <option value="Rajasthan" <%=QueryData.state==='Rajasthan'
                                                            ? 'selected' : '' %>>Rajasthan</option>

                                                        <option value="Sikkim" <%=QueryData.state==='Sikkim'
                                                            ? 'selected' : '' %>>Sikkim</option>

                                                        <option value="Tamil Nadu" <%=QueryData.state==='Tamil Nadu'
                                                            ? 'selected' : '' %>>Tamil Nadu</option>

                                                        <option value="Telangana" <%=QueryData.state==='Telangana'
                                                            ? 'selected' : '' %>>Telangana</option>

                                                        <option value="Tripura" <%=QueryData.state==='Tripura'
                                                            ? 'selected' : '' %>>Tripura</option>

                                                        <option value="Uttaranchal" <%=QueryData.state==='Uttaranchal'
                                                            ? 'selected' : '' %>
                                                            >Uttaranchal</option>

                                                        <option value="Uttar Pradesh"
                                                            <%=QueryData.state==='Uttar Pradesh' ? 'selected' : '' %>
                                                            >Uttar Pradesh</option>

                                                        <option value="West Bengal" <%=QueryData.state==='West Bengal'
                                                            ? 'selected' : '' %>
                                                            >West Bengal</option>

                                                        <option value="UNION Territories"
                                                            <%=QueryData.state==='UNION Territories' ? 'selected' : ''
                                                            %>>UNION
                                                            Territories

                                                        </option>

                                                        <option value="Andaman and Nicobar Islands"
                                                            <%=QueryData.state==='Andaman and Nicobar Islands'
                                                            ? 'selected' : '' %>>Andaman and

                                                            Nicobar Islands</option>

                                                        <option value="Chandigarh" <%=QueryData.state==='Chandigarh'
                                                            ? 'selected' : '' %>>Chandigarh</option>

                                                        <option value="Dadar and Nagar Haveli"
                                                            <%=QueryData.state==='Dadar and Nagar Haveli' ? 'selected'
                                                            : '' %>
                                                            >Dadar and Nagar

                                                            Haveli</option>

                                                        <option value="Daman and Diu"
                                                            <%=QueryData.state==='Daman and Diu' ? 'selected' : '' %>
                                                            >Daman and Diu</option>

                                                        <option value="Delhi" <%=QueryData.state==='Delhi' ? 'selected'
                                                            : '' %>
                                                            >Delhi</option>

                                                        <option value="Lakshadeep" <%=QueryData.state==='Lakshadeep'
                                                            ? 'selected' : '' %>>Lakshadeep</option>

                                                        <option value="Pondicherry" <%=QueryData.state==='Pondicherry'
                                                            ? 'selected' : '' %>
                                                            >Pondicherry</option>

                                                    </select>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="text-right mb-3">
                                            <!-- <a href="./retailerkycstatus"
                                                class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</a> -->
                                            <button type="reset"
                                                class="btn  btn-outline-alternate custom-button  reset-anchor mr-3 mt-3">Reset</button>

                                            <button type="submit"
                                                class="btn-shadow  btn btn-primary custom-btn  btn-lg mt-3">Apply</button>

                                        </div>
                                    </form>
                                </div>

                                <div>
                                    <table id="exampless" class="table table-striped table-bordered table-responsive"
                                        cellspacing="0">
                                        <thead>

                                            <tr>
                                                <th class="tabel-width">MONTH</th>
                                                <th class="tabel-width">SALESMAN CODE</th>
                                                <th class="tabel-width">SALESMAN NAME</th>
                                                <th class="tabel-width">SALESMAN TYPE</th>
                                                <th class="tabel-width">KYC DATE</th>
                                                <th class="tabel-width">VERIFICATION DATE</th>
                                                <th class="tabel-width">AUTHENTICATION DATE</th>
                                                <th class="tabel-width">STATUS</th>
                                                <th class="tabel-width">MODIFIED DATE</th>
                                                <th class="tabel-width">CHANNEL TYPE</th>
                                            </tr>
                                        </thead>


                                        <tbody>
                                            <% KYCStatusData.forEach((data)=> { %>
                                                <tr>
                                                    <td>
                                                        <%= data.month_name%>
                                                    </td>
                                                    <td>
                                                        <%= data.awsm_code%>
                                                    </td>
                                                    <td>
                                                        <%= data.awsm_name%>
                                                    </td>
                                                    <td>
                                                        <%= data.salesman_type%>
                                                    </td>
                                                    <td>
                                                        <%= data.created_on.toLocaleDateString('en-IN') %>
                                                    </td>
                                                    <td>
                                                        <% if (data.kyc_type==='FRESH' && data.status==='SUCCESS' ) { %>
                                                            <%= (data.approved_on)?
                                                                data.approved_on.toLocaleDateString('en-IN'):'' %>
                                                                <% } else if (data.kyc_type==='RE-KYC-Request' &&
                                                                    data.status==='SUCCESS' ) { %>
                                                                    <%= (data.replace_kyc_edit_on)?
                                                                        data.replace_kyc_edit_on.toLocaleDateString('en-IN'): ''
                                                                        %>
                                                                        <% } else if (data.kyc_type==='Edit-KYC-Request'
                                                                            && data.status==='SUCCESS' ) { %>
                                                                            <%= data.approved_kyc_edit_on ?
                                                                                data.approved_kyc_edit_on.toLocaleDateString('en-IN'): ''
                                                                                %>
                                                                                <% } %>
                                                    </td>
                                                    <td>
                                                        <%= data.authentication_date%>
                                                    </td>
                                                    <td>
                                                        <%= data.status%>
                                                    </td>
                                                    <td data-order="1000">
                                                        <%= data.channel%>
                                                    </td>
                                                </tr>
                                                <%})%>
                                        </tbody>

                                    </table>
                                    <div class="dataTables_paginate paging_simple_numbers" id="example_paginate">
                                        <a href="/retailerkycstatus?page=<%= currentPage - 1 %>"
                                            class="paginate_button previous <%= startPage === 1 ? 'disabled' : '' %>"
                                            aria-controls="example" data-dt-idx="0" tabindex="-1"
                                            id="example_previous">Previous</a>
                                        <span>
                                            <% for (let i=startPage; i <=endPage; i++) { %>
                                                <a href="/retailerkycstatus?page=<%=i%>" class="paginate_button current"
                                                    aria-controls="example" data-dt-idx="<%=i %>" tabindex="0">
                                                    <%= i %>
                                                </a>
                                                <% } %>
                                        </span>
                                        <a href="/retailerkycstatus?page=<%= (parseInt(currentPage) + 1) %>"
                                            class="paginate_button next <%= endPage === totalRows ? 'disabled' : '' %>"
                                            aria-controls="example" id="example_next">Next</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <% } %>

                <script>

                    function fnExcelReport(file, RetailerCode, salesman_type, Month, Year, awsm_state) {
                        fetch(`/retailerkycstatus/export?RetailerCode=${RetailerCode}&salesman_type=${salesman_type}&Month=${Month}&Year=${Year}&awsm_state=${awsm_state}`)
                            .then((res) => res.json())
                            .then((data) => {
                                data.forEach((item) => {
                                    item.dob = formatDate(item.dob);
                                    item.created_on = formatDate(item.created_on);
                                    item.insert_timestamp = formatDate(item.insert_timestamp);
                                    item.update_timestamp = formatDate(item.update_timestamp);
                                    item.approved_on = formatDate(item.approved_on);
                                    item.bank_account_no = formatBankAccount(item.bank_account_no);
                                });

                                const csvContent = createCSV(data);

                                var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                                var url = URL.createObjectURL(blob);
                                var link = document.createElement("a");
                                link.setAttribute("href", url);
                                link.setAttribute("download", file);
                                link.style.visibility = 'hidden';
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                            })
                            .catch((error) => {
                                console.error("Error fetching data: ", error);
                            });
                    }

                    function formatDate(dateString) {
                        const date = new Date(dateString);
                        const year = date.getFullYear();
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const day = String(date.getDate()).padStart(2, '0');
                        return `${year}-${month}-${day}`;
                    }

                    function formatBankAccount(accountNumber) {
                        return accountNumber.match(/.{1,4}/g).join(' ');
                    }

                    function createCSV(data) {
                        // const replacer = (key, value) => value === null ? '' : value;
                        // const header = Object.keys(data[0])
                        // const csvContent = [
                        //     header.join(','),
                        //     ...data.map(row => header.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(','))
                        // ].join('\r\n');
                        // return csvContent;


                        const headers = [
                            "MONTH",
                            "SALESMAN CODE",
                            "SALESMAN NAME",
                            "SALESMAN TYPE",
                            "KYC DATE",
                            "VERIFICATION DATE",
                            "AUTHENTICATION DATE",
                            "STATUS",
                            "MODIFIED DATE",
                            "CHANNEL TYPE"
                        ];


                        const flattenData = data.map(item => ({
                            "MONTH": item.month_name,
                            "SALESMAN CODE": item.RetailerCode,
                            "SALESMAN NAME": item.awsm_name,
                            "SALESMAN TYPE": item.salesman_type,
                            "KYC DATE": item.insert_timestamp,
                            "VERIFICATION DATE": item.approved_on,
                            "AUTHENTICATION DATE": "",
                            "STATUS": item.status,
                            "MODIFIED DATE": item.update_timestamp,
                            "CHANNEL TYPE": item.channel
                        }));

                        const replacer = (key, value) => (value === null ? "" : value);
                        const csvContent = [headers.join(","), ...flattenData.map(row => headers.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(","))].join("\r\n");
                        return csvContent;
                    }

                    document.getElementById("btnExport")
                        .addEventListener("click", function () {
                            var filename = "retailerkycstatus.csv";
                            var awsm_code = document.getElementById("awsm_code").value;
                            var salesman_type = document.getElementById("salesman_type").value;
                            var Month = document.getElementById("Month").value;
                            var Year = document.getElementById("Year").value;
                            var awsm_state = document.getElementById("awsm_state").value;
                            fnExcelReport(filename, awsm_code, salesman_type, Month, Year, awsm_state);
                        }, false);
                </script>

                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        var table = document.querySelector('#example');
                        var dataTable = new DataTable(table, {
                            dom: '<"dt-buttons"Bf><"clear">lirtp',
                            paging: true,
                            autoWidth: true,
                            buttons: [
                                {
                                    extend: 'excelHtml5',
                                    text: 'Excel',
                                    filename: 'DataTableExcel',
                                    exportOptions: {
                                        columns: ':visible'
                                    }
                                }
                            ]
                        });
                    });

                </script>
                <%- include("../shared/footer"); %>